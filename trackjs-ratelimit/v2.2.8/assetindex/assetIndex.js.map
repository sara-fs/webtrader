{"version":3,"sources":["../../../../src/assetindex/assetIndex.es6"],"names":["table_el","asset_win_el","header_el","dialog_buttons_el","init","li","click","windows","createBlankWindow","title","i18n","dialogClass","minWidth","minHeight","track","module_id","is_unique","data","dialog","require","initAssetWin","moveToTop","state","dropdown","display_markets","display_submarkets","is_volatility","sorted_markets","market_submarkets","selected_market","table","asset_data","asset_data_extract","display_headers","display_asset_data","search_input","search","event","isTableRowSearchValue","asset","value","toLowerCase","indexOf","updateDisplayTable","filter","checkVolatility","market_name","market_names","volatility_indices","innerText","initTable","getActiveSymAndAssetsData","then","result","populateTable","catch","error","$","growl","message","console","active_symbols_data","local_storage","get","filtered_active_symbols","filterRestrictedSymbols","asset_index_data","asset_index","isEmptyObject","parent","find","addClass","marketsDropdown","submarketsDropdown","updateTable","val","submarket_name","symbols","rows","map","props","symbol","push","forEach","asset_type","asset_list","asset_from","asset_to","assignAssetRows","fillFalseRows","row_result","assets","temp_asset","Array","length","isArray","asset_from_to","indexhead","header_length","i","row","markets_sorted_list","makeSelectmenu","insertAfter","list","inx","changed","submarket_list","Object","keys","update_list","width","selectmenu","submarkets","sorted_submarkets","processing_msg","attr","show","asset_index_request","Promise","all","liveapi","cached","send","results","hide","resolve","reject","$html","appendTo","rv","bind","events","on"],"mappings":"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","file":"assetIndex.js","sourcesContent":["ï»¿import $ from 'jquery';\nimport windows from '../windows/windows';\nimport liveapi from '../websockets/binary_websockets';\nimport rv from 'common/rivetsExtra';\nimport 'jquery-growl';\nimport 'css!./assetIndex.css';\nimport { getObjectMarketSubmarkets, getSortedMarkets, getSortedSubmarkets } from '../common/marketUtils';\nimport 'common/util'\n\nlet table_el = null;\nlet asset_win_el = null;\nlet header_el = null;\nlet dialog_buttons_el = null;\n\nexport const init = (li) => {\n    li.click(() => {\n        if (!asset_win_el) {\n            asset_win_el = windows.createBlankWindow($('<div/>'), {\n                title: 'Asset Index'.i18n(),\n                dialogClass: 'assetIndex',\n                minWidth: 800,\n                minHeight: 400,\n            });\n            asset_win_el.track({\n                module_id: 'assetIndex',\n                is_unique: true,\n                data: null\n            });\n            asset_win_el.dialog('open');\n            require(['text!assetindex/assetIndex.html'], initAssetWin);\n        } else\n            asset_win_el.moveToTop();\n    });\n}\n\nconst state = {\n    dropdown: {\n        display_markets: null,\n        display_submarkets: null,\n        is_volatility: false,\n        sorted_markets: null,\n        market_submarkets: null,\n        selected_market: null\n    },\n    table: {\n        asset_data: [],\n        asset_data_extract: [],\n        display_headers: [],\n        display_asset_data: [],\n        search_input: ''\n    },\n    search: function (event) {\n        function isTableRowSearchValue(asset) {\n            const value = state.table.search_input.toLowerCase();\n            return asset[0].toLowerCase().indexOf(value.toLowerCase()) !== -1;\n        }\n\n        return (function updateDisplayTable() {\n            state.table.display_asset_data = [];\n            state.table.display_asset_data = state.table.asset_data_extract.filter(isTableRowSearchValue);\n            state.dropdown.is_volatility = checkVolatility(state.dropdown.selected_market, state.dropdown.display_markets);\n        })();\n    }\n}\n\nconst checkVolatility = (market_name, market_names) => {\n    const volatility_indices = market_names[0][3] ? market_names[0][3].innerText : market_names[0][0].innerText; // locate vol_ind (handle translation)\n    const is_volatility = market_name.indexOf(volatility_indices) !== -1;\n\n    return is_volatility;\n}\n\nconst initTable = () => {\n    getActiveSymAndAssetsData()\n        .then((result) => {\n            populateTable(result);\n        })\n        .catch((error) => {\n            $.growl.error({ message: error.message });\n            console.error(error);\n        });\n\n    function populateTable(result) {\n        const active_symbols_data = local_storage.get('active_symbols');\n        const filtered_active_symbols = filterRestrictedSymbols(active_symbols_data);\n        const asset_index_data = [...result[0].asset_index];\n\n        if($.isEmptyObject(filtered_active_symbols) && $.isEmptyObject(asset_index_data)) return;\n\n        state.dropdown.market_submarkets = getObjectMarketSubmarkets(filtered_active_symbols);\n        state.dropdown.sorted_markets = getSortedMarkets(filtered_active_symbols);\n        state.table.asset_data = asset_index_data;\n\n        header_el = asset_win_el.parent().find('.ui-dialog-title').addClass('with-content');\n        dialog_buttons_el = asset_win_el.parent().find('.ui-dialog-titlebar-buttonpane');\n\n        marketsDropdown(state.dropdown.market_submarkets);\n        submarketsDropdown(state.dropdown.market_submarkets);\n        updateTable(state.dropdown.display_markets.val(), state.dropdown.display_submarkets.val());\n\n        function updateTable(market_name, submarket_name) {\n            const symbols = [...state.dropdown.market_submarkets[market_name][submarket_name]];\n            state.dropdown.selected_market = market_name;\n            state.dropdown.is_volatility = checkVolatility(market_name, state.dropdown.display_markets);\n            let rows = state.table.asset_data\n                .filter((asset) => symbols.indexOf(asset[1]) > -1) // asset[1] is symbol\n                .map((asset) => {\n                    const props = [];\n                    const symbol = asset[1];\n                    const asset_data = asset[2];\n                    state.table.display_headers = [];\n                    props.push(symbol);\n                    asset_data.forEach(asset_list => {\n                        const asset_type = asset_list[1];\n                        const asset_from = asset_list[2];\n                        const asset_to = asset_list[3];\n                        state.table.display_headers.push(asset_type);\n                        props.push([asset_type, `${asset_from} - ${asset_to}`]);\n                    });\n\n                    return props;\n                });\n            rows = assignAssetRows(rows);\n            rows = fillFalseRows(rows);\n\n            state.table.display_asset_data = rows;\n            state.table.asset_data_extract = rows;\n\n            function assignAssetRows(rows) {\n                const row_result = [];\n                rows.forEach((assets) => {\n                    const temp_asset = new Array(state.table.display_headers.length + 1);\n                    assets.forEach(asset => {\n                        if (Array.isArray(asset)) {\n                            const asset_type = asset[0];\n                            const asset_from_to = asset[1];\n                            const indexhead = state.table.display_headers.indexOf(asset_type) + 1;\n                            temp_asset[indexhead] = asset_from_to;\n                        } else {\n                            temp_asset[0] = asset;\n                        }\n                    });\n                    row_result.push(temp_asset);\n                });\n                return row_result;\n            }\n\n            function fillFalseRows(rows) {\n                const header_length = state.table.display_headers.length;\n\n                for (let i = 0; i <= header_length; i++) {\n                    rows.forEach(row => {\n                        if (!row[i] || Array.isArray(row[i])) {\n                            row[i] = '-';\n                        }\n                    });\n                }\n\n                return rows;\n            }\n        }\n\n        function marketsDropdown(market_submarkets) {\n            const markets_sorted_list = state.dropdown.sorted_markets;\n\n            if (!state.dropdown.display_markets) {\n                state.dropdown.display_markets = windows\n                    .makeSelectmenu($('<select />').insertAfter(asset_win_el), {\n                        list: markets_sorted_list,\n                        inx: 0,\n                        changed: (val) => {\n                            const submarket_list = getSortedSubmarkets(Object.keys(market_submarkets[val]));\n                            state.dropdown.display_submarkets.update_list(submarket_list);\n                            updateTable(state.dropdown.display_markets.val(), state.dropdown.display_submarkets.val());\n                        },\n                        width: '180px'\n                    });\n                state.dropdown.display_markets.selectmenu('widget').addClass('asset-index-selectmenu');\n            } else {\n                state.dropdown.display_markets.update_list(markets_sorted_list);\n            }\n        }\n\n        function submarketsDropdown(market_submarkets) {\n            const submarkets = Object.keys(market_submarkets[state.dropdown.display_markets.val()]);\n            const sorted_submarkets = getSortedSubmarkets(submarkets);\n\n            if (!state.dropdown.display_submarkets) {\n                state.dropdown.display_submarkets = windows\n                    .makeSelectmenu($('<select />').insertAfter(asset_win_el), {\n                        list: sorted_submarkets,\n                        inx: 0,\n                        changed: (val) => {\n                            updateTable(state.dropdown.display_markets.val(), state.dropdown.display_submarkets.val());\n                        },\n                        width: '200px'\n                    });\n                state.dropdown.display_submarkets.selectmenu('widget').addClass('asset-index-selectmenu');\n            } else {\n                state.dropdown.display_submarkets.update_list(sorted_submarkets);\n            }\n        }\n    }\n\n    function getActiveSymAndAssetsData() {\n        const processing_msg = $(`#${table_el.attr('id')}_processing`).show();\n        const asset_index_request = { asset_index: 1 };\n\n        return Promise.all(\n            [\n                liveapi.cached.send(asset_index_request),\n            ])\n            .then((results) => {\n                processing_msg.hide();\n                return Promise.resolve(results);\n            })\n            .catch((error) => {\n                processing_msg.hide();\n                return Promise.reject(error);\n            });\n    };\n}\n\nconst initAssetWin = ($html) => {\n    $html = $($html).i18n();\n    table_el = $html.filter('table');\n    $html.appendTo(asset_win_el);\n    rv.bind($html[0], state);\n    initTable();\n    require(['websockets/binary_websockets'], (liveapi) => {\n      liveapi.events.on('login', initTable);\n      liveapi.events.on('logout', initTable);\n   });\n}\n\nexport default {\n    init\n}"]}